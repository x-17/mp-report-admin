import{_ as e,W as a,a1 as i,$ as t,s,M as r,a2 as l,ai as n,N as o,o as d,c as u,w as f,i as m,a as c,e as y,d as p,t as h,b as g,F as v,g as C,h as _,q as F,v as N,u as I}from"./index-b4e560e4.js";import{_ as k,a as x}from"./uni-list.8f559f9a.js";import{_ as b}from"./uni-easyinput.a8fa748d.js";import{_ as j}from"./uni-forms-item.65d5ea4b.js";import{_ as A}from"./uni-forms.74dc0c32.js";import{_ as V}from"./uni-id-pages-agreements.6fff87ad.js";import{m as T}from"./login-page.mixin.454a16c5.js";import"./uni-popup-dialog.aadba8a2.js";a.importObject("uni-id-co");const w=e({mixins:[T],data:()=>({realName:"",idCard:"",certifyId:"",verifyFail:!1,verifyFailCode:0,verifyFailTitle:"",verifyFailContent:""}),computed:{userInfo:()=>i.userInfo,certifyIdNext(){return Boolean(this.realName)&&Boolean(this.idCard)&&this.needAgreements&&this.agree},isCertify(){return this.userInfo.realNameAuth&&2===this.userInfo.realNameAuth.authStatus},isDev:()=>!1},onLoad(){const e=t("uni-id-pages-temp-frv");e&&(this.realName=e.realName,this.idCard=e.idCard)},methods:{async getCertifyId(){if(this.certifyIdNext)return s({content:"暂不支持实名认证",showCancel:!1})},startFacialRecognitionVerify(){},async getFrvAuthResult(){const e=a.importObject("uni-id-co",{customUI:!0});try{r({title:"验证中...",mask:!1});const a=await e.getFrvAuthResult({certifyId:this.certifyId}),{errCode:i,...t}=a;this.verifyFailContent&&console.log(`[frv-debug] 客户端刷脸失败，由实人认证服务查询具体原因，原因：${this.verifyFailContent}`),s({content:"实名认证成功",showCancel:!1,success:()=>{l.setUserInfo({realNameAuth:t}),this.verifyFail=!1}}),n({key:"uni-id-pages-temp-frv"})}catch(i){this.verifyFail=!0,this.verifyFailTitle=i.errMsg,console.error(JSON.stringify(i))}finally{o()}},retry(){10013!==this.verifyFailCode?this.getCertifyId():this.verifyFail=!1}}},[["render",function(e,a,i,t,s,r){const l=C(_("uni-list-item"),k),n=C(_("uni-list"),x),o=F,T=m,w=N,U=I,O=C(_("uni-easyinput"),b),R=C(_("uni-forms-item"),j),B=C(_("uni-forms"),A),D=C(_("uni-id-pages-agreements"),V);return d(),u(T,null,{default:f((()=>[r.isCertify?(d(),u(n,{key:0},{default:f((()=>[c(l,{class:"item",title:"姓名",rightText:r.userInfo.realNameAuth.realName},null,8,["rightText"]),c(l,{class:"item",title:"身份证号码",rightText:r.userInfo.realNameAuth.identity},null,8,["rightText"])])),_:1})):(d(),u(T,{key:1,class:"uni-content"},{default:f((()=>[s.verifyFail?(d(),y(v,{key:0},[c(T,{class:"face-icon"},{default:f((()=>[c(o,{src:"/admin/assets/face-verify-icon-da277dd7.svg",class:"face-icon-image"})])),_:1}),c(T,{class:"error-title"},{default:f((()=>[p(h(s.verifyFailTitle),1)])),_:1}),c(T,{class:"error-description"},{default:f((()=>[p(h(s.verifyFailContent),1)])),_:1}),10013!==s.verifyFailCode?(d(),u(w,{key:0,type:"primary",onClick:r.retry},{default:f((()=>[p("重新开始验证")])),_:1},8,["onClick"])):(d(),u(w,{key:1,type:"primary",onClick:r.retry},{default:f((()=>[p("返回")])),_:1},8,["onClick"])),r.isDev?(d(),u(T,{key:2,class:"dev-tip"},{default:f((()=>[p("请在控制台查看详细错误（此提示仅在开发环境展示）")])),_:1})):g("",!0)],64)):(d(),y(v,{key:1},[c(U,{class:"title"},{default:f((()=>[p("实名认证")])),_:1}),c(B,null,{default:f((()=>[c(R,{name:"realName"},{default:f((()=>[c(O,{placeholder:"姓名",class:"input-box",modelValue:s.realName,"onUpdate:modelValue":a[0]||(a[0]=e=>s.realName=e),clearable:!1},null,8,["modelValue"])])),_:1}),c(R,{name:"idCard"},{default:f((()=>[c(O,{placeholder:"身份证号码",class:"input-box",modelValue:s.idCard,"onUpdate:modelValue":a[1]||(a[1]=e=>s.idCard=e),clearable:!1},null,8,["modelValue"])])),_:1})])),_:1}),c(D,{scope:"realNameVerify",ref:"agreements",style:{"margin-bottom":"20px"}},null,512),c(w,{type:"primary",disabled:!r.certifyIdNext,onClick:r.getCertifyId},{default:f((()=>[p("确定")])),_:1},8,["disabled","onClick"])],64))])),_:1}))])),_:1})}],["__scopeId","data-v-6b998579"]]);export{w as default};
