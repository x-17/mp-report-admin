import{_ as e,an as t,ao as i,o as n,c as s,w as l,d as u,t as a,D as r,I as o,u as p,au as d,g as h,h as m,z as c,b as g,a as f,i as y,v as S,av as x,a6 as $,e as _,F as b,f as w,q as k,W as v,aq as z,at as C,p as W,ar as N}from"./index-b4e560e4.js";import{_ as U}from"./u-icon.ace97cee.js";const I=e({name:"u-link",mixins:[t,i,{props:{color:{type:String,default:()=>uni.$u.props.link.color},fontSize:{type:[String,Number],default:()=>uni.$u.props.link.fontSize},underLine:{type:Boolean,default:()=>uni.$u.props.link.underLine},href:{type:String,default:()=>uni.$u.props.link.href},mpTips:{type:String,default:()=>uni.$u.props.link.mpTips},lineColor:{type:String,default:()=>uni.$u.props.link.lineColor},text:{type:String,default:()=>uni.$u.props.link.text}}}],computed:{linkStyle(){return{color:this.color,fontSize:uni.$u.addUnit(this.fontSize),lineHeight:uni.$u.addUnit(uni.$u.getPx(this.fontSize)+2),textDecoration:this.underLine?"underline":"none"}}},emits:["click"],methods:{openLink(){window.open(this.href),this.$emit("click")}}},[["render",function(e,t,i,d,h,m){const c=p;return n(),s(c,{class:"u-link",onClick:r(m.openLink,["stop"]),style:o([m.linkStyle,e.$u.addStyle(e.customStyle)])},{default:l((()=>[u(a(e.text),1)])),_:1},8,["onClick","style"])}],["__scopeId","data-v-0f79af8b"]]);const M=e({name:"u--text",mixins:[t,i,{computed:{value(){const{text:e,mode:t,format:i,href:n}=this;return"price"===t?(/^\d+(\.\d+)?$/.test(e)||uni.$u.error("金额模式下，text参数需要为金额格式"),uni.$u.test.func(i)?i(e):uni.$u.priceFormat(e,2)):"date"===t?(!uni.$u.test.date(e)&&uni.$u.error("日期模式下，text参数需要为日期或时间戳格式"),uni.$u.test.func(i)?i(e):i?uni.$u.timeFormat(e,i):uni.$u.timeFormat(e,"yyyy-mm-dd")):"phone"===t?uni.$u.test.func(i)?i(e):"encrypt"===i?`${e.substr(0,3)}****${e.substr(7)}`:e:"name"===t?("string"!=typeof e&&uni.$u.error("姓名模式下，text参数需要为字符串格式"),uni.$u.test.func(i)?i(e):"encrypt"===i?this.formatName(e):e):"link"===t?(!uni.$u.test.url(n)&&uni.$u.error("超链接模式下，href参数需要为URL格式"),e):e}},methods:{formatName(e){let t="";if(2===e.length)t=e.substr(0,1)+"*";else if(e.length>2){let i="";for(let t=0,n=e.length-2;t<n;t++)i+="*";t=e.substr(0,1)+i+e.substr(-1,1)}else t=e;return t}}},{props:{type:{type:String,default:()=>uni.$u.props.text.type},show:{type:Boolean,default:()=>uni.$u.props.text.show},text:{type:[String,Number],default:()=>uni.$u.props.text.text},prefixIcon:{type:String,default:()=>uni.$u.props.text.prefixIcon},suffixIcon:{type:String,default:()=>uni.$u.props.text.suffixIcon},mode:{type:String,default:()=>uni.$u.props.text.mode},href:{type:String,default:()=>uni.$u.props.text.href},format:{type:[String,Function],default:()=>uni.$u.props.text.format},call:{type:Boolean,default:()=>uni.$u.props.text.call},openType:{type:String,default:()=>uni.$u.props.text.openType},bold:{type:Boolean,default:()=>uni.$u.props.text.bold},block:{type:Boolean,default:()=>uni.$u.props.text.block},lines:{type:[String,Number],default:()=>uni.$u.props.text.lines},color:{type:String,default:()=>uni.$u.props.text.color},size:{type:[String,Number],default:()=>uni.$u.props.text.size},iconStyle:{type:[Object,String],default:()=>uni.$u.props.text.iconStyle},decoration:{tepe:String,default:()=>uni.$u.props.text.decoration},margin:{type:[Object,String,Number],default:()=>uni.$u.props.text.margin},lineHeight:{type:[String,Number],default:()=>uni.$u.props.text.lineHeight},align:{type:String,default:()=>uni.$u.props.text.align},wordWrap:{type:String,default:()=>uni.$u.props.text.wordWrap}}}],emits:["click"],computed:{valueStyle(){const e={textDecoration:this.decoration,fontWeight:this.bold?"bold":"normal",wordWrap:this.wordWrap,fontSize:uni.$u.addUnit(this.size)};return!this.type&&(e.color=this.color),this.isNvue&&this.lines&&(e.lines=this.lines),this.lineHeight&&(e.lineHeight=uni.$u.addUnit(this.lineHeight)),!this.isNvue&&this.block&&(e.display="block"),uni.$u.deepMerge(e,uni.$u.addStyle(this.customStyle))},isNvue:()=>!1,isMp:()=>!1},data:()=>({}),methods:{clickHandler(){this.call&&"phone"===this.mode&&d({phoneNumber:this.text}),this.$emit("click")}}},[["render",function(e,t,i,r,d,x){const $=p,_=h(m("u-icon"),U),b=y,w=h(m("u-link"),I),k=S;return e.show?(n(),s(b,{key:0,class:c(["u-text",[]]),style:o({margin:e.margin,justifyContent:"left"===e.align?"flex-start":"center"===e.align?"center":"flex-end"}),onClick:x.clickHandler},{default:l((()=>["price"===e.mode?(n(),s($,{key:0,class:c(["u-text__price",e.type&&`u-text__value--${e.type}`]),style:o([x.valueStyle])},{default:l((()=>[u("￥")])),_:1},8,["class","style"])):g("",!0),e.prefixIcon?(n(),s(b,{key:1,class:"u-text__prefix-icon"},{default:l((()=>[f(_,{name:e.prefixIcon,customStyle:e.$u.addStyle(e.iconStyle)},null,8,["name","customStyle"])])),_:1})):g("",!0),"link"===e.mode?(n(),s(w,{key:2,class:c(["u-text__value",[e.type&&`u-text__value--${e.type}`,e.lines&&`u-line-${e.lines}`]]),style:o({fontWeight:x.valueStyle.fontWeight,wordWrap:x.valueStyle.wordWrap,fontSize:x.valueStyle.fontSize}),text:e.value,href:e.href,underLine:""},null,8,["style","class","text","href"])):e.openType&&x.isMp?(n(),s(k,{key:3,class:"u-reset-button u-text__value",style:o([x.valueStyle]),"data-index":e.index,openType:e.openType,onGetuserinfo:e.onGetUserInfo,onContact:e.onContact,onGetphonenumber:e.onGetPhoneNumber,onError:e.onError,onLaunchapp:e.onLaunchApp,onOpensetting:e.onOpenSetting,lang:e.lang,"session-from":e.sessionFrom,"send-message-title":e.sendMessageTitle,"send-message-path":e.sendMessagePath,"send-message-img":e.sendMessageImg,"show-message-card":e.showMessageCard,"app-parameter":e.appParameter},{default:l((()=>[u(a(e.value),1)])),_:1},8,["style","data-index","openType","onGetuserinfo","onContact","onGetphonenumber","onError","onLaunchapp","onOpensetting","lang","session-from","send-message-title","send-message-path","send-message-img","show-message-card","app-parameter"])):(n(),s($,{key:4,class:c(["u-text__value",[e.type&&`u-text__value--${e.type}`,e.lines&&`u-line-${e.lines}`]]),style:o([x.valueStyle])},{default:l((()=>[u(a(e.value),1)])),_:1},8,["style","class"])),e.suffixIcon?(n(),s(b,{key:5,class:"u-text__suffix-icon"},{default:l((()=>[f(_,{name:e.suffixIcon,customStyle:e.$u.addStyle(e.iconStyle)},null,8,["name","customStyle"])])),_:1})):g("",!0)])),_:1},8,["style","onClick"])):g("",!0)}],["__scopeId","data-v-785b2f33"]]);const H=e({name:"u-album",mixins:[t,i,{props:{urls:{type:Array,default:()=>uni.$u.props.album.urls},keyName:{type:String,default:()=>uni.$u.props.album.keyName},singleSize:{type:[String,Number],default:()=>uni.$u.props.album.singleSize},multipleSize:{type:[String,Number],default:()=>uni.$u.props.album.multipleSize},space:{type:[String,Number],default:()=>uni.$u.props.album.space},singleMode:{type:String,default:()=>uni.$u.props.album.singleMode},multipleMode:{type:String,default:()=>uni.$u.props.album.multipleMode},maxCount:{type:[String,Number],default:()=>uni.$u.props.album.maxCount},previewFullImage:{type:Boolean,default:()=>uni.$u.props.album.previewFullImage},rowCount:{type:[String,Number],default:()=>uni.$u.props.album.rowCount},showMore:{type:Boolean,default:()=>uni.$u.props.album.showMore}}}],data:()=>({singleWidth:0,singleHeight:0,singlePercent:.6}),watch:{urls:{immediate:!0,handler(e){1===e.length&&this.getImageRect()}}},emits:["albumWidth"],computed:{imageStyle(){return(e,t)=>{const{space:i,rowCount:n,multipleSize:s,urls:l}=this,{addUnit:u,addStyle:a}=uni.$u,r=this.showUrls.length;this.urls.length;const o={marginRight:u(i),marginBottom:u(i)};return e===r&&(o.marginBottom=0),(t===n||e===r&&t===this.showUrls[e-1].length)&&(o.marginRight=0),o}},showUrls(){const e=[];return this.urls.map(((t,i)=>{if(i+1<=this.maxCount){const n=Math.floor(i/this.rowCount);e[n]||(e[n]=[]),e[n].push(t)}})),e},imageWidth(){return uni.$u.addUnit(1===this.urls.length?this.singleWidth:this.multipleSize)},imageHeight(){return uni.$u.addUnit(1===this.urls.length?this.singleHeight:this.multipleSize)},albumWidth(){let e=0;return e=1===this.urls.length?this.singleWidth:this.showUrls[0].length*this.multipleSize+this.space*(this.showUrls[0].length-1),this.$emit("albumWidth",e),e}},methods:{onPreviewTap(e){const t=this.urls.map((e=>this.getSrc(e)));x({current:e,urls:t})},getSrc(e){return uni.$u.test.object(e)?this.keyName&&e[this.keyName]||e.src:e},getImageRect(){const e=this.getSrc(this.urls[0]);$({src:e,success:e=>{const t=e.width>=e.height;this.singleWidth=t?this.singleSize:e.width/e.height*this.singleSize,this.singleHeight=t?e.height/e.width*this.singleWidth:this.singleSize},fail:()=>{this.getComponentWidth()}})},async getComponentWidth(){await uni.$u.sleep(30),this.$uGetRect(".u-album__row").then((e=>{this.singleWidth=e.width*this.singlePercent}))}}},[["render",function(e,t,i,u,a,r){const p=k,d=h(m("up-text"),M),c=y;return n(),s(c,{class:"u-album"},{default:l((()=>[(n(!0),_(b,null,w(r.showUrls,((t,i)=>(n(),s(c,{class:"u-album__row",ref_for:!0,ref:"u-album__row",forComputedUse:r.albumWidth,key:i},{default:l((()=>[(n(!0),_(b,null,w(t,((t,u)=>(n(),s(c,{class:"u-album__row__wrapper",key:u,style:o([r.imageStyle(i+1,u+1)]),onClick:i=>e.previewFullImage?r.onPreviewTap(r.getSrc(t)):""},{default:l((()=>[f(p,{src:r.getSrc(t),mode:1===e.urls.length?r.imageHeight>0?e.singleMode:"widthFix":e.multipleMode,style:o([{width:r.imageWidth,height:r.imageHeight}])},null,8,["src","mode","style"]),e.showMore&&e.urls.length>e.rowCount*r.showUrls.length&&i===r.showUrls.length-1&&u===r.showUrls[r.showUrls.length-1].length-1?(n(),s(c,{key:0,class:"u-album__row__wrapper__text"},{default:l((()=>[f(d,{text:"+"+(e.urls.length-e.maxCount),color:"#fff",size:.3*e.multipleSize,align:"center",customStyle:"justify-content: center"},null,8,["text","size"])])),_:1})):g("",!0)])),_:2},1032,["style","onClick"])))),128))])),_:2},1032,["forComputedUse"])))),128))])),_:1})}],["__scopeId","data-v-6c4463d6"]]),T=e({__name:"report-detail",setup(e){const t=v.database();let i=z(""),a=z(""),r=z([]);return C((e=>{i.value=e.id,async function(){try{let e=await t.collection("report-info").where(`_id=="${i.value}"`).field("image[url],text").get({getOne:!0});a.value=e.result.data.text,e.result.data.image&&(r.value=e.result.data.image),console.log(e)}catch(e){W({title:"获取数据失败",icon:"error"}),console.log(e)}}()})),(e,t)=>{const i=p,o=h(m("u-text"),M),d=y,c=h(m("u-album"),H);return n(),s(d,{class:"box"},{default:l((()=>[f(d,{class:"top"},{default:l((()=>[f(i,{class:"label"},{default:l((()=>[u("上报内容")])),_:1}),f(o,{text:N(a),wordWrap:"anywhere",mode:"text"},null,8,["text"])])),_:1}),f(d,{class:"img"},{default:l((()=>[f(i,{class:"label"},{default:l((()=>[u("图片")])),_:1}),N(r).length?(n(),s(c,{key:0,urls:N(r)||"",keyName:"url",maxCount:6,multipleSize:"200",singleSize:"200"},null,8,["urls"])):(n(),s(i,{key:1,class:"label"},{default:l((()=>[u("暂无图片")])),_:1}))])),_:1})])),_:1})}}},[["__scopeId","data-v-2505fe35"]]);export{T as default};
